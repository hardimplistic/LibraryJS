"use strict";function isNull(a){return null==a||0===a.length}function convertEmptyToNull(a){return isNull(a)?null:a}function StringValue(a,b){return void 0===a||null==number?b?String(b):"":String(a)}function StringNumber(a,b){return void 0===a||null==a?b?String(b):"0":String(a)}function Timestamp(a){var b=a>0?a:Date.now();return this.getTime=function(){return b},this.getDate=function(){return new Date(b)},this.toString=function(){return b+""},this}function getLocationRedirect(a){if(a.startsWith("http://")||a.startsWith("https://")||a.startsWith("file://"))return a;var b=[];b.push(location.protocol),b.push("//"),b.push(location.host),a?a.startsWith("/")?b.push(a):location.pathname.endsWith("/")?(b.push(location.pathname),b.push(a)):(b.push(location.pathname),location.pathname.endsWith("/")||b.push("/"),b.push("../"),b.push(a)):b.push(location.pathname);var c=new URL(b.join(""));return c.href}function LocationRedirect(a,b){var c=getLocationRedirect(a);b&&(this._debugger=b),this._debugger?confirm("Location Redirect: "+c)&&(location.href=c):location.href=c}function LocationHref(a){var b="",c=[a];return this.put=function(a,d){void 0!=d&&null!=d&&""!=d&&(b=c.join(""),1==c.length&&b.indexOf("?")==-1?c.push("?"+a+"="+(d?encodeURIComponent(d):"")):c.push("&"+a+"="+(d?encodeURIComponent(d):"")))},this.get=function(){return c.join("")},this.forward=function(){location.href=this.get()},this}function LocationHash(){var a=["#"];return this.put=function(b,c){void 0!=c&&null!=c&&""!=c&&a.push(b+"="+(c?encodeURIComponent(c):""))},this.get=function(){return a.join("&")},this}function getSearchParameter(a,b){if(location.search&&location.search.substring(1)){var c,d=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");return(c=location.search.substring(1).match(d))?decodeURIComponent(c[2]):b?b:null}return b?b:null}function getHashParameter(a,b){if(location.hash&&location.hash.substring(1)){var c,d=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");return(c=location.hash.substring(1).match(d))?decodeURIComponent(c[2]):b?b:null}return b?b:null}function getStringParameter(a,b,c){if(a&&"#"==a.substring(0,1)&&(a=a.substring(1)),a){var d,e=new RegExp("(^|&)"+b+"=([^&]*)(&|$)");return(d=a.match(e))?decodeURIComponent(d[2]):c?c:null}return c?c:null}function WAjaxCall(a,b,c){$.ajax(a).done(function(a,d,e){b&&$.isFunction(b)&&(200==a.status?b(a):WFail.failApi(a,d,e,b,c))}).fail(function(a,d,e){return"timeout"==d?void WFail.failTimeOut(null,d,a,b,c):void WFail.failHttp(null,d,a,b,c)})}function WJsonCall(a,b,c,d){var e={type:"POST",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:WConfig.ajax.timeout};WAjaxCall(e,c,d)}function WDeleteJsonCall(a,b,c,d){var e={type:"DELETE",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:WConfig.ajax.timeout};WAjaxCall(e,c,d)}function WPutJsonCall(a,b,c,d){var e={type:"PUT",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:WConfig.ajax.timeout};WAjaxCall(e,c,d)}function WPostJsonCall(a,b,c,d){WJsonCall(a,b,c,d)}function WBodyCall(a,b,c,d){WJsonCall(a,b,c,d)}function WPostCall(a,b,c,d){var e={type:"POST",url:a,data:b,timeout:WConfig.ajax.timeout};WAjaxCall(e,c,d)}function WGetCall(a,b,c,d){var e={type:"GET",url:a,data:b,timeout:WConfig.ajax.timeout};WAjaxCall(e,c,d)}function PAjaxCall(a,b,c){$.ajax(a).done(function(a,d,e){"timeout"==d?c({response:null,textStatus:d,jqXHR:e,errorThrown:null}):a.status==PConfig.ajax.loginStatus?location.href=PConfig.ajax.loginUrl:200!=a.status?c({response:a,textStatus:d,jqXHR:e,errorThrown:a.message}):200==a.status?b(a):c({response:a,textStatus:d,jqXHR:e,errorThrown:null})}).fail(function(a,b,d){c({response:null,textStatus:b,jqXHR:a,errorThrown:d})})}function PJsonCall(a,b){return new Promise(function(c,d){var e={type:"POST",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout};PAjaxCall(e,c,d)})}function PBodyCall(a,b){return PJsonCall(a,b)}function PPostCall(a,b){return new Promise(function(c,d){var e={type:"POST",url:a,data:b,timeout:PConfig.ajax.timeout};PAjaxCall(e,c,d)})}function PGetCall(a,b){return new Promise(function(c,d){var e={type:"GET",url:a,data:b,timeout:PConfig.ajax.timeout};PAjaxCall(e,c,d)})}function PPostJsonCall(a,b){return new Promise(function(c,d){var e={type:"POST",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout};PAjaxCall(e,c,d)})}function PPutJsonCall(a,b){return new Promise(function(c,d){var e={type:"PUT",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout};PAjaxCall(e,c,d)})}function PDeleteJsonCall(a,b){return new Promise(function(c,d){var e={type:"DELETE",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout};PAjaxCall(e,c,d)})}function PAccessToken(a){return void 0===a?WStorage.getItem("PAccessToken"):(WStorage.setItem("PAccessToken",a),WStorage.getItem("PAccessToken"))}function PTokenJsonCall(a,b){return new Promise(function(c,d){var e={type:"POST",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout,headers:function(){var a={};return a[PConfig.ajax.tokenKey]=PAccessToken(),a}()};PAjaxCall(e,c,d)})}function PTokenBodyCall(a,b){return PTokenJsonCall(a,b)}function PTokenPostCall(a,b){return new Promise(function(c,d){var e={type:"POST",url:a,data:b,timeout:PConfig.ajax.timeout,headers:function(){var a={};return a[PConfig.ajax.tokenKey]=PAccessToken(),a}()};PAjaxCall(e,c,d)})}function PTokenGetCall(a,b){return new Promise(function(c,d){var e={type:"GET",url:a,data:b,timeout:PConfig.ajax.timeout,headers:function(){var a={};return a[PConfig.ajax.tokenKey]=PAccessToken(),a}()};PAjaxCall(e,c,d)})}function PTokenPostJsonCall(a,b){return new Promise(function(c,d){var e={type:"POST",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout,headers:function(){var a={};return a[PConfig.ajax.tokenKey]=PAccessToken(),a}()};PAjaxCall(e,c,d)})}function PTokenPutJsonCall(a,b){return new Promise(function(c,d){var e={type:"PUT",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout,headers:function(){var a={};return a[PConfig.ajax.tokenKey]=PAccessToken(),a}()};PAjaxCall(e,c,d)})}function PTokenDeleteJsonCall(a,b){return new Promise(function(c,d){var e={type:"DELETE",url:a,data:$.toJSON(b),dataType:"json",contentType:"application/json;charset=utf-8",timeout:PConfig.ajax.timeout,headers:function(){var a={};return a[PConfig.ajax.tokenKey]=PAccessToken(),a}()};PAjaxCall(e,c,d)})}function formValue(a,b){var c=a[0].elements,d={};return $.each(c,function(a,c){var e=$(c),f=e.attr("name");if(!f){if(b!==!0)return;var g=e.attr("id");if(!g)return;f=g}d[f]=null}),$.each(c,function(a,c){var e=$(c),f=e.attr("name");if(!f){if(b!==!0)return;var g=e.attr("id");if(!g)return;f=g}var h=c.tagName.toLowerCase();if("select"===h)return void(d[f]=e.val());if("textarea"===h)return void(d[f]=e.val());var i=e.attr("type").toLowerCase();if("radio"===i)return void(c.checked&&(d[f]=e.val()));if("checkbox"!==i)return["text","password","hidden"].indexOf(i)>-1?void(d[f]=e.val()):void(d[f]=e.val());if(c.checked&&"true"===e.attr("data-multi")){var j=d[f];j||(j=d[f]=[]),j.push(e.val())}else c.checked&&(d[f]=e.val())}),d}function formValueById(a,b){return formValue($("#"+a),b)}function Chain(){var a=this;return a.index=0,a.chain=[],a.reset=function(){a.index=0},a.clear=function(){a.chain=[],a.index=0},a.method=function(b){a.chain.push(b)},a.start=function(){if(0!=a.chain.length){var b=function(c){var d=a.chain[++a.index];d&&d(b,c)};a.chain[0](b)}},a}function AsyncQueue(){var a=this;a.queue=[],a.countdown=0,a._finish=function(){},a.reset=function(){a.countdown=0},a.action=function(b){a.queue.push(b)},a.finish=function(b){a._finish=b},a.start=function(){if(0!=a.queue.length){var b=function(){++a.countdown==a.queue.length&&a._finish()};for(var c in a.queue)a.queue[c](b)}}}function depthValue(a,b,c){var d=null;d="string"==typeof b?b.split("."):b;for(var e=a,f=d.length,g=0;g<f&&"object"==typeof e;g++){var h=d.shift();if(e=e[h],void 0==e)return void 0==c?null:c}return e}function arrayObjectColumnSumToNumber(a,b){if(!a||0==a.length)return 0;var c=0;for(var d in a){var e=a[d],f=depthValue(e,b);void 0!=f&&"object"!=typeof f&&("string"!=typeof f?"number"!=typeof f||(c+=f):c+=f.toFloat())}return c}function arrayObjectColumnSumToString(a,b,c){if(!a||0==a.length)return"";c=c?c:", ";var d="";for(var e in a){var f=a[e],g=depthValue(f,b);void 0!=g&&"object"!=typeof g&&(d.length>0&&(d+=c),d+=g)}return d}function arrayObjectColumnNumberValueSubArray(a,b,c,d){if(!a||0==a.length)return[];var e=[];for(var f in a){var g=a[f],h=depthValue(g,b);void 0!=h&&"object"!=typeof h&&h>=c&&h<=d&&e.push(g)}return e}function arrayObjectColumnInNumberValueSubArray(a,b,c){if(!a||0==a.length)return[];var d=[];for(var e in a){var f=a[e],g=depthValue(f,b);void 0!=g&&"object"!=typeof g&&c.indexOf(g)>-1&&d.push(f)}return d}function arraysMergeToArrayObject(){var a=arguments;if(a<2)return[];for(var b=[],c=a[0],d=a[1],e=0;e<d.length;e++){var f={};for(var g in c){var h=c[g],i=a[g.toInteger()+1][e];f[h]=i}b.push(f)}return b}function arrayObjectAppendColumn(a,b,c){for(var d in a)a[d][b]=c;return a}function arrayObjectValuesByColumn(a,b){var c=[];for(var d in a){var e=a[d];c.push(e[b])}return c}function arrayObjectToMapByColumn(a,b){var c={};for(var d in a)c[a[d][b]]=a[d];return c}function uuid(a,b){var c,d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=[];if(b=b||d.length,a)for(c=0;c<a;c++)e[c]=d[0|Math.random()*b];else{var f;for(e[8]=e[13]=e[18]=e[23]="-",e[14]="4",c=0;c<36;c++)e[c]||(f=0|16*Math.random(),e[c]=d[19==c?3&f|8:f])}return e.join("")}function guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}function CreateID(a){return a||(a="ID"),"{0}_{1}_{2}".format(a,uuid(8,16),Math.round(100*Math.random()))}function uniqueid(a,b){a=a?a:"",b=b?b:"";var c=(new Date).getTime().toString(16).toUpperCase(),d=Math.random().toString(16).substring(2).toUpperCase();return a+b+c+","+d}function javaIntValue(a){var b=2147483647,c=-2147483648;return a>b||a<c?a&=4294967295:a}function javaHashCode(a){var b=0;if(!isNull(a))for(var c=0;c<a.length;c++)b=31*b+a.charCodeAt(c),b=javaIntValue(b);return b}function DialogPromise(a){var b=this;this.resultStatus=0,this.result={value:null,dialog:null},this.resolveCallback=function(){},this.rejectCallback=function(){},this.resolve=function(a,c){b.resultStatus=1,b.result={value:a,dialog:c},b.resolveCallback&&b.resolveCallback(a,c)},this.reject=function(a,c){this.resultStatus=2,this.result={value:a,dialog:c},b.rejectCallback&&b.rejectCallback(a,c)},this.then=function(a,c){b.resolveCallback=a,b.rejectCallback=c,1===b.resultStatus?b.resolveCallback&&b.resolveCallback(this.result.value,this.result.dialog):2===b.resultStatus&&b.rejectCallback&&b.rejectCallback(b.result.value,b.result.dialog)},a(this.resolve,this.reject)}String.prototype.startsWith||!function(){var a=function(){try{var a={},b=Object.defineProperty,c=b(a,a,a)&&b}catch(d){}return c}(),b={}.toString,c=function(a){if(null==this)throw TypeError();var c=String(this);if(a&&"[object RegExp]"==b.call(a))throw TypeError();var d=c.length,e=String(a),f=e.length,g=arguments.length>1?arguments[1]:void 0,h=g?Number(g):0;h!=h&&(h=0);var i=Math.min(Math.max(h,0),d);if(f+i>d)return!1;for(var j=-1;++j<f;)if(c.charCodeAt(i+j)!=e.charCodeAt(j))return!1;return!0};a?a(String.prototype,"startsWith",{value:c,configurable:!0,writable:!0}):String.prototype.startsWith=c}(),String.prototype.endsWith||(String.prototype.endsWith=function(a,b){return(void 0===b||b>this.length)&&(b=this.length),this.substring(b-a.length,b)===a}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}),Date.prototype.format||(Date.prototype.format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a}),String.prototype.toInteger||(String.prototype.toInteger=function(){var a=this.replace(/\s/g,"").replace(/,/g,"");return""!=a&&0==isNaN(a)?parseInt(a,10):0}),String.prototype.toFloat||(String.prototype.toFloat=function(){var a=this.replace(/\s/g,"").replace(/,/g,"");return""!=a&&0==isNaN(a)?parseFloat(a,10):0}),String.prototype.toBoolean||(String.prototype.toBoolean=function(){return"true"==this}),String.prototype.toHashCode||(String.prototype.toHashCode=function(){return javaHashCode(this)}),LocationRedirect.prototype._debugger=!1;var WConfig={ajax:{timeout:5e5,loginStatus:80403,loginUrl:"/login.html"}},WFail={failHttp:function(a,b,c,d,e){if(d&&$.isFunction(d)){if(e)return void d({data:e,status:c.status,message:c.statusText});d({data:null,status:c.status,message:c.statusText})}},failApi:function(a,b,c,d,e){switch(a.status){case WConfig.ajax.loginStatus:location.href=WConfig.ajax.loginUrl}if(d&&$.isFunction(d)){if(e)return void d({data:e,status:a.status,message:a.message});d({data:null,status:a.status,message:a.message})}},failTimeOut:function(a,b,c,d,e){if(d&&$.isFunction(d)){if(e)return void d({data:e,status:c.status,message:c.statusText});d({data:null,status:c.status,message:c.statusText})}}},PConfig={ajax:{timeout:5e5,loginStatus:80403,loginUrl:"/login.html",tokenKey:"token",responseInterceptors:[function(a){return!0},function(a){return!0}]},appendResponseInterceptors:function(a){PConfig.ajax.responseInterceptors.push(a)}},WStorage={setItem:function(a,b){var c=$.type(b);switch(c){case"object":case"array":localStorage.setItem("_type_"+a,c),localStorage.setItem(a,$.toJSON(b));break;default:localStorage.setItem("_type_"+a,c),localStorage.setItem(a,b)}},getItem:function(a){var b=localStorage.getItem("_type_"+a),c=localStorage.getItem(a);switch(b){case"object":case"array":c=$.parseJSON(c);default:return c}},removeItem:function(a){localStorage.removeItem("_type_"+a),localStorage.removeItem(a)},clear:function(){localStorage.clear()}},WCookie={setItem:function(a,b){var c=$.type(b);switch(c){case"object":case"array":localStorage.setItem("_type_c_"+a,c),$.cookie(a,$.toJSON(b),{path:"/"});break;default:localStorage.setItem("_type_c_"+a,c),$.cookie(a,b,{path:"/"})}},getItem:function(a){var b=localStorage.getItem("_type_c_"+a),c=localStorage.getItem(a);switch(b){case"object":case"array":c=$.parseJSON($.cookie(a));default:return c}},removeItem:function(a){localStorage.removeItem("_type_c_"+a),localStorage.removeItem(a)}},MediaCache={};MediaCache.ImageLoad=function(a,b,c){var d=new Map,e=$("#MediaCacheImageContainer");0===e.length&&(e=$('<div id="MediaCacheImageContainer"/>').hide()),a.forEach(function(a,f){d.set(a,!1);var g=a;c===!0&&(g+=g.indexOf("?")===-1?"?v="+(new Date).getTime():"&v="+(new Date).getTime());var h=CreateID(),i=$("<img/>").attr("id",h).attr("src",g).attr("data-src",a);i[0].onload=function(){var a=$(this).data("src");d.set(a,!0),b&&b(a,d)},e.append(i)}),$("body").append(e)},MediaCache.AudioLoad=function(a,b,c){var d=new Map,e=$("#MediaCacheAudioContainer");0===e.length&&(e=$('<div id="MediaCacheAudioContainer"/>').hide()),a.forEach(function(a,f){d.set(a,!1);var g=CreateID(),h=$('<audio preload="auto" muted/>').attr("id",g).attr("data-src",a);c===!0&&(a+=a.indexOf("?")===-1?"?v="+(new Date).getTime():"&v="+(new Date).getTime());var i=$('<source src="" type="audio/mpeg"/>').attr("src",a);h.append(i);var j=h[0];j.load(),j.addEventListener("canplaythrough",function(){var a=$(this).data("src");d.set(a,!0),b&&b(a,d)},!1),e.append(h)}),$("body").append(e)};var AssertJS={active:!1,Utils:{isDebugModeInSearchQuery:function(){if(location.search&&location.search.substring(1)){var a,b="debugger",c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)");if(a=location.search.substring(1).match(c))return AssertJS.Utils.equals(unescape(a[2]))}return!1},equals:function(a,b){return a==b},isNull:function(a){return null==a},isGreaterThan:function(a,b){return a>b},isLessThan:function(a,b){return a<b},isStringEmpty:function(a){return AssertJS.Utils.isNull(a)||AssertJS.Utils.equals(a.length,0)},isObjectEmpty:function(a){if(AssertJS.Utils.isNull(a))return!0;var b=0;for(var c in a){b++;break}return AssertJS.Utils.equals(b,0)},isArrayEmpty:function(a){return AssertJS.Utils.isNull(a)||AssertJS.Utils.equals(a.length,0)}},Debug:{isDebugMode:function(){return 1==AssertJS.active},isNull:function(a){AssertJS.Debug.isDebugMode()&&AssertJS.Utils.isNull(a)},isArrayEmpty:function(a){AssertJS.Debug.isDebugMode()&&AssertJS.Utils.isArrayEmpty(a)}}},MDialog={cacheContainerId:"m-dialog-cache-template-container",hideTask:[],hideTaskIntervalId:0,Close:function(a){a&&a.remove()}};MDialog.template=function(a,b){var c=$("#"+a).html();if(c)return void b(c);var d=$("#m-dialog-cache-template-container");if(0===d.length)d=$('<div id="m-dialog-cache-template-container" style="display: none;"/>').appendTo("body"),d.load("/dialogs.html?v="+Date.now(),function(){console.log("container loaded");var c=$("#m-dialog-cache-template-container #"+a).html();b(c)});else{var c=$("#m-dialog-cache-template-container #"+a).html();b(c)}},MDialog.templateByUrl=function(a,b){var c="TMP"+javaHashCode(a),d=$("#"+c);0===d.length?(d=$('<div id="'+c+'" style="display: none;"/>').appendTo("body"),d.load(a+"?v="+Date.now(),function(){console.log("container loaded"),b()})):b()},MDialog.Alert=function(a){var b={title:"",message:""},c=$.extend(b,a);return new DialogPromise(function(a,b){MDialog.template("m-dialog-alert",function(b){var d=$(b).appendTo("body");$(".modal-title",d).html(c.title?c.title:"消息"),$(".modal-body",d).html(c.message),$(".btn-primary",d).click(function(b){d.modal("hide"),a()}),d.on("show.bs.modal",function(a){console.log("show.bs.modal")}),d.on("shown.bs.modal",function(a){console.log("shown.bs.modal")}),d.on("hide.bs.modal",function(a){console.log("hide.bs.modal")}),d.on("hidden.bs.modal",function(a){console.log("hidden.bs.modal"),d.remove()}),d.modal({backdrop:!1,keyboard:!1,show:!0})})})},MDialog.Confirm=function(a){var b={title:"",message:""},c=$.extend(b,a);return new DialogPromise(function(a,b){MDialog.template("m-dialog-confirm",function(d){var e=$(d).appendTo("body");$(".modal-title",e).html(c.title?c.title:"消息"),$(".modal-body",e).html(c.message),$(".btn-primary",e).click(function(b){e.modal("hide"),a()}),$(".btn-default",e).click(function(a){e.modal("hide"),b()}),e.on("show.bs.modal",function(a){console.log("show.bs.modal")}),e.on("shown.bs.modal",function(a){console.log("shown.bs.modal")}),e.on("hide.bs.modal",function(a){console.log("hide.bs.modal")}),e.on("hidden.bs.modal",function(a){console.log("hidden.bs.modal"),e.remove()}),e.modal({backdrop:!1,keyboard:!1,show:!0})})})};var wbcache={emotions:null},wb={str62keys:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",int10to62:function(a){for(var b="",c=0;0!=a;)c=a%62,b=this.str62keys.charAt(c)+b,a=Math.floor(a/62);return b},str62to10:function(a){for(var b=0,c=0;c<a.length;c++){var d=a.length-c-1,e=a.substr(c,1);b+=parseInt(this.str62keys.indexOf(e))*Math.pow(62,d)}return b},id2mid:function(a){if("string"!=typeof a)return!1;for(var b="",c=a.length-7;c>-7;c-=7){var d=c<0?0:c,e=c+7,f=a.substring(d,e);f=wb.int10to62(f),b=f+b}return b},mid2id:function(a){for(var b="",c=a.length-4;c>-4;c-=4){var d=c<0?0:c,e=c<0?parseInt(a.length%4):4,f=a.substr(d,e);if(f=wb.str62to10(f).toString(),d>0)for(;f.length<7;)f="0"+f;b=f+b}return b},thumb150:function(a){var b=a.substring(a.lastIndexOf("/")+1);return"http://wx3.sinaimg.cn/thumb150/"+b},proxythumb150:function(a){return a=wb.thumb150(a),"/api/resource/image/proxy?url="+encodeURIComponent(a)},proxyimage:function(a){return"/api/resource/image/proxy?url="+encodeURIComponent(a)},textarea:{insert:function(a,b){if(document.selection)a.focus(),sel=document.selection.createRange(),sel.text=b,sel.select();else if(a.selectionStart||"0"==a.selectionStart){var c=a.selectionStart,d=a.selectionEnd,e=a.scrollTop;a.value=a.value.substring(0,c)+b+a.value.substring(d,a.value.length),e>0&&(a.scrollTop=e),a.focus(),a.selectionStart=c+b.length,a.selectionEnd=c+b.length}else a.value+=b,a.focus()}}},wbui={getWeiboCard:function(a,b){var c={mode:"view",sessionRecord:"on",checkbox:"on",onLoadMoreCardEvent:function(){}},d=$.extend(c,b),e="";switch(wbui.getWeiboFromType(a.task)){case"statuses":e=wbui.statuses;break;case"retweet":e=wbui.retweet;break;case"comment":e=wbui.comment;break;default:e=function(){return""}}return a.task.picUrls&&(a.task.picUrls=$.parseJSON(a.task.picUrls)),a.task.retweetedStatus&&(a.task.retweetedStatus=$.parseJSON(a.task.retweetedStatus)),a.task.commentStatus&&(a.task.commentStatus=$.parseJSON(a.task.commentStatus)),a.task.geo&&(a.task.geo=$.parseJSON(a.task.geo)),e(a,d)},getWeiboFromType:function(a){var b="";switch(a.type){case"MyStatuses":case"Statuses":b="statuses";break;case"MyRetweeted":case"Retweeted":b="retweet";break;case"AtMeComments":case"ToMeComments":b="comment";break;case"Keywords":switch(a.subType){case"KeywordRetweeted":b="retweet";break;case"KeywordStatuses":b="statuses"}}return b},userHeader:function(a,b){var c="";c+='<div class="card-header">',c+='    <div class="user-block">',c+='        <img class="img-circle" src="{0}" alt="User Image">'.format(wb.proxyimage(a.profileImageUrl)),c+='        <span class="username"><a target="_blank" href="{1}">{0}</a></span>'.format(a.screenName,"https://m.weibo.cn/u/"+a.idstr),c+='        <span class="description">',c+="            关注({0})".format(a.friendsCount),c+="            粉丝({0})".format(a.followersCount),c+="            微博({0})".format(a.statusesCount),c+="        </span>",c+="    </div>",c+='    <div class="card-tools">',c+='        <button type="button" class="btn btn-tool" data-toggle="tooltip" title="微博用户设置" data-action="weibo-user-settings">',c+="            设置备注",c+="        </button>",c+="    </div>",c+="</div>";var d=$(c);return d.data(a),d.find("[data-action]").click(function(){var a=$(this).closest(".card-header").data(),b=$(this).data("action");switch(b){case"weibo-user-settings":MDialog.openWbUserSettingsDialog({idstr:a.idstr})}}),d},weiboFrom:function(a){var b="";switch(a.type){case"MyStatuses":b="我的原创";break;case"MyRetweeted":b="我的转发";break;case"Retweeted":b="转发微博";break;case"Statuses":b="原创微博";break;case"AtMeComments":b="at我的评论";break;case"ToMeComments":b="评论";break;case"Keywords":switch(a.subType){case"KeywordRetweeted":b="关键词转发微博";break;case"KeywordStatuses":b="关键词原创微博"}}return'<span class="text-muted"><i class="fas fa-tags"></i> {0}</span>'.format(b)},atTime:function(a){return a.pubdate?'<span class="text-muted"><i class="far fa-clock"></i> {0}</span>'.format(moment(a.pubdate).format("YYYY-MM-DD HH:mm:ss")):a.createAt?'<span class="text-muted"><i class="far fa-clock"></i> {0}</span>'.format(moment(a.createAt).format("YYYY-MM-DD HH:mm:ss")):'<span class="text-muted"><i class="far fa-clock"></i> 未知</span>'},uniqueMid:function(a){return'<span class="text-muted"><i class="fas fa-anchor"></i> {0}</span>'.format(a.midShort)},assignInfo:function(a){return a.manager&&a.agent?"true"===a.agent.unwantedAssign?'<span class="text-muted"><i class="fas fa-angle-double-right"></i> {0}设置为无需分配</span>'.format(a.manager.realName):'<span class="text-muted"><i class="fas fa-angle-double-right"></i> {0}分配给{1}</span>'.format(a.manager.realName,a.agent.realName):""},taskStatus:function(a){var b="";return a.agent&&"true"===a.agent.unwantedAssign?"":(a.status&&(b=1===a.status.processResult?"已回复":2===a.status.processResult?"无需回复":[2,5].indexOf(a.status.assignStatus)>-1?"已分配":"未分配"),b?'<span class="text-muted"><i class="fas fa-tasks"></i> {0}</span>'.format(b):"")},checkbox:function(a,b){if("off"===b.checkbox)return"";var c=CreateID(),d="";d+='<div class="custom-control custom-checkbox" style="float: right;">',d+='    <input class="custom-control-input checkbox-item" type="checkbox" id="{0}" value="{1}">'.format(c,a.idstr),d+='    <label for="{0}" class="custom-control-label" style="font-weight: 400; cursor: pointer;">选择</label>'.format(c),d+="</div>";var e=$(d);return e.find(".checkbox-item").data(a).change(function(){this.checked||$('.task-toolbar [data-action="select-all"]').removeClass("selected").html("批量选择")}),e},mediaBody:function(a){var b=$("<div/>");if(a.picUrls&&a.picUrls.length){var c=a.picUrls,d=3;4===c.length&&(d=2);var e=$("<div/>"),f=null;c.forEach(function(a,b){f&&b%d!==0||(f=$('<div class="wb-image-container type-image-4"/>').appendTo(e));var c=wb.proxythumb150(a.thumbnail_pic),g="";g+='<div class="wb-image-inner">',g+="    <div>",g+='        <img src="{0}">'.format(c),g+="    </div>",g+="</div>",f.append(g)}),b.append(e)}else if(a.thumbnailPic||a.thumbnail_pic){var g=a.thumbnailPic||a.thumbnail_pic,h=wb.proxythumb150(g),i="";i+='<div class="wb-image-container">',i+='    <div class="wb-image-inner">',i+="        <div>",i+='            <img src="{0}">'.format(h),i+="        </div>",i+="    </div>",i+="</div>",b.append(i)}return b},toolsbar:function(a,b){var c="";c+='<div class="card-body toolsbar" style="border-top: 1px dashed rgba(0,0,0,.125);">',c+='    <div class="btn-group float-sm-left">',c+='        <button type="button" class="btn btn-outline-secondary btn-xs btn-width-80" data-action="original-weibo">微博原文</button>',"on"===b.sessionRecord&&(c+='        <button type="button" class="btn btn-outline-secondary btn-xs btn-width-80" data-action="session-record">对话记录</button>'),c+="    </div>",c+='    <div class="btn-group float-sm-right">',"assign"===b.mode?(c+='<button type="button" class="btn btn-outline-secondary btn-xs btn-width-80" data-action="assign-unwanted">无需分配</button>',c+='<button type="button" class="btn btn-outline-secondary btn-xs btn-width-80 dropdown-toggle dropdown-icon" data-action="assign" data-toggle="dropdown" aria-expanded="false">',c+='    立即分配 <span class="sr-only">Toggle Dropdown</span>',c+='    <div class="dropdown-menu" role="menu" x-placement="bottom-start">',c+="    </div>",c+="</button>"):"reply"===b.mode&&(c+='<button type="button" class="btn btn-outline-secondary btn-xs btn-width-80" data-action="reply-unwanted">无需回复</button>',c+='<button type="button" class="btn btn-outline-secondary btn-xs btn-width-80" data-action="reply">立即回复</button>'),c+="    </div>",c+="</div>";var d=$(c).data(a);return d.attr("data-idstr",a.task.idstr),d.attr("data-userIdstr",a.task.userIdstr),d.find("[data-action]").click(function(){var a=$(this),c=a.closest(".toolsbar").data(),d=a.data("action");switch(d){case"assign-unwanted":var e=a.closest(".toolsbar").data("idstr");apis.batchUnwantedTask([e]).then(function(a){var c=$('.card-widget[data-idstr="{0}"]'.format(e));c.slideUp(160,function(){c.remove(),b.onLoadMoreCardEvent()})});break;case"assign":apis.getOnlineAgents().then(function(c){var d=c.data,e=$(".dropdown-menu",a).empty();$('<a class="dropdown-item" href="#" data-unwanted="true">无需分配</a>').appendTo(e),$('<div class="dropdown-divider"></div>').appendTo(e),d.forEach(function(a){$('<a class="dropdown-item" href="#" data-unwanted="false"/>').attr("data-username",a.userName).html("{0} ({1})".format(a.realName,a.userName)).appendTo(e)}),0===d.length&&$('<a class="dropdown-item" href="#"/>').html('<i style="color: grey;">暂无客服在线</i>').appendTo(e),e.find(".dropdown-item").click(function(){var a=$(this).data("unwanted"),c=$(this).data("username"),d=$(this).closest(".toolsbar").data("idstr");console.log(a,c,d);var e=apis.batchAssignTask;return a===!0&&(e=apis.batchUnwantedTask),e([d],c).then(function(a){var c=$('.card-widget[data-idstr="{0}"]'.format(d));c.slideUp(160,function(){c.remove(),b.onLoadMoreCardEvent()})}),!1})});break;case"reply":var f=a.closest(".card").find(".replybox");f.is(":hidden")&&f.slideDown();break;case"reply-unwanted":var e=a.closest(".toolsbar").data("idstr");apis.batchUnwantedReply([e]).then(function(a){var c=$('.card-widget[data-idstr="{0}"]'.format(e));c.slideUp(160,function(){c.remove(),b.onLoadMoreCardEvent()})});break;case"session-record":var g=a.closest(".card").find(".direct-chat-messages");if(g.is(":hidden")){g.empty();var h=a.closest(".card").data();console.log("task",h);var i=null,j=null;switch(h.type){case"MyStatuses":case"MyRetweeted":case"Retweeted":case"Statuses":case"Keywords":i=h.idstr;break;case"AtMeComments":case"ToMeComments":j=h.idstr}apis.getTimelineReply(i,j).then(function(a){var b=WApp.getPropSystemUserIdstr(),c=a.data;if(c.forEach(function(a){if(a.comments){var c="";c+='    <div class="direct-chat-msg">',c+='        <div class="direct-chat-infos clearfix">',c+='            <span class="direct-chat-name float-left">{0}</span>'.format(a.user.screenName),c+='            <span class="direct-chat-timestamp float-right">{0}</span>'.format(moment(a.comments.pubdate).format("YYYY/MM/DD HH:mm:ss")),c+="        </div>",c+='        <img class="direct-chat-img" src="{0}" alt="message user image">'.format(wb.proxyimage(a.user.profileImageUrl)),c+='        <div class="direct-chat-text">',c+="            "+a.comments.text,c+="        </div>",c+="    </div>";var d=$(c);a.user.idstr===b&&d.addClass("right"),g.append(d)}}),0===g.find(".direct-chat-msg").length){var d="";d+='    <div class="direct-chat-msg" style="text-align: center; margin-bottom: 0px;">',d+="        <i>暂无对话记录</i>",d+="    </div>",g.append(d)}g.slideDown("slow")})}else g.slideUp();break;case"original-weibo":var k=c.task.idstr,l=c.task.idstr;c.task.commentStatus&&(k=c.task.commentStatus.user.id,l=c.task.commentStatus.idstr);var m="https://weibo.com/{0}/{1}".format(k,wb.id2mid(l));window.open(m)}}),d},timeline:function(a,b){var c="";c+='<div class="direct-chat-messages direct-chat-warning" style="border-top: 1px dashed rgba(0,0,0,.125); display: none;">',c+='    <div class="direct-chat-msg">',c+='        <div class="direct-chat-infos clearfix">',c+='            <span class="direct-chat-name float-left">Alexander Pierce</span>',c+='            <span class="direct-chat-timestamp float-right">23 Jan 2:00 pm</span>',c+="        </div>",c+='        <img class="direct-chat-img" src="/api/resource/image/proxy?url=https%3A%2F%2Ftvax1.sinaimg.cn%2Fcrop.0.0.996.996.180%2F6b948f49ly8gdiva7fk2uj20ro0rowha.jpg%3FKID%3Dimgbed%2Ctva%26Expires%3D1587987333%26ssig%3D0Fwva%252BedXi" alt="message user image">',c+='        <div class="direct-chat-text">',c+="            Is this template really for free? That",c+="        </div>",c+="    </div>",c+='    <div class="direct-chat-msg right">',c+='        <div class="direct-chat-infos clearfix">',c+='            <span class="direct-chat-name float-right">Sarah Bullock</span>',c+='            <span class="direct-chat-timestamp float-left">23 Jan 2:05 pm</span>',c+="        </div>",c+='        <img class="direct-chat-img" src="/api/resource/image/proxy?url=https%3A%2F%2Ftvax1.sinaimg.cn%2Fcrop.0.0.996.996.180%2F6b948f49ly8gdiva7fk2uj20ro0rowha.jpg%3FKID%3Dimgbed%2Ctva%26Expires%3D1587987333%26ssig%3D0Fwva%252BedXi" alt="message user image">',c+='        <div class="direct-chat-text">',c+="            You better believe it!",c+="        </div>",c+="    </div>",c+="</div>";var d=$(c);return d},replyBox:function(a,b){var c="";c+='<div class="card-footer replybox" style="display: none;">',c+='\t<form onsubmit="return false">',c+='\t\t<img class="img-fluid img-circle img-sm" src="{0}">'.format(WApp.getPropSystemUserImg()),c+='\t\t<div class="img-push">',
c+='\t\t\t<textarea name="replyContent" class="form-control form-control-sm" placeholder="回复内容" rows="5"></textarea>',c+='\t\t    <div style="margin-top: 10px;">',c+='\t\t        <button type="button" class="btn btn-outline-secondary btn-xs btn-width-80" data-action="insert-emoji">插入表情</button>',c+='\t\t        <button type="button" class="btn btn-outline-secondary btn-xs btn-width-80" data-action="fast-reply">快捷回复</button>',c+='\t\t        <button type="button" class="btn btn-secondary btn-xs btn-width-80" style="float: right;" data-action="send-reply">发送</button>',c+="\t\t    </div>",c+="\t\t</div>",c+="\t</form>",c+="</div>";var d=$(c);return d.data(a),d.find("[data-action]").click(function(){var a=$(this),c=a.closest(".replybox").data(),d=a.data("action");switch(d){case"insert-emoji":if(a.parent().find(".card-quickreply-box").fadeOut(180),a.parent().find(".card-face-box").length)return void a.parent().find(".card-face-box").fadeIn(180);var e="";e+='<div class="card card-primary card-outline card-face-box">',e+='<div class="card-header">',e+='  <h3 class="card-title">微博表情</h3>',e+='  <div class="card-tools">',e+='    <button type="button" class="btn btn-tool btn-face-card-remove"><i class="fas fa-times"></i>',e+="    </button>",e+="  </div>",e+="</div>",e+='  <div class="card-body pad">',e+="  </div>",e+="</div>";var f=$(e);f.find(".btn-face-card-remove").click(function(){$(this).closest(".card-face-box").fadeOut(180)});var g=a.position();f.css("position","absolute"),f.css("top",g.top+26),f.css("left",g.left),f.css("width","400px"),f.css("height","300px"),f.css("z-index","99999"),a.parent().append(f);var h=function(b){var c=f.find(".card-body");b.forEach(function(b){if(["face"].indexOf(b.type)!==-1){var d=$('<div class="face-inner"><img src="{0}" onerror="$(this).parent().remove()" /></div>'.format(wb.proxyimage(b.icon))).data(b).appendTo(c);d.click(function(){var b=$(this).data();console.log(b);var c=a.closest(".card").find('textarea[name="replyContent"]')[0];wb.textarea.insert(c,b.phrase)})}})};wbcache.emotions?h(wbcache.emotions):apis.emotions().then(function(a){var b=a.data;wbcache.emotions=b,h(wbcache.emotions)});break;case"fast-reply":if(a.parent().find(".card-face-box").fadeOut(180),a.parent().find(".card-quickreply-box").length)return void a.parent().find(".card-quickreply-box").fadeIn(180);var e="";e+='<div class="card card-primary card-outline card-quickreply-box">',e+='<div class="card-header">',e+='  <h3 class="card-title">快速回复</h3>',e+='  <div class="card-tools">',e+='    <button type="button" class="btn btn-tool btn-quickreply-card-remove"><i class="fas fa-times"></i>',e+="    </button>",e+="  </div>",e+="</div>",e+='  <div class="card-body pad" style="padding: 10px;">',e+="  </div>",e+="</div>";var f=$(e);f.find(".btn-quickreply-card-remove").click(function(){$(this).closest(".card-quickreply-box").fadeOut(180)});var g=a.position();f.css("position","absolute"),f.css("top",g.top+26),f.css("left",g.left),f.css("width","400px"),f.css("height","300px"),f.css("z-index","99999"),a.parent().append(f);var i=function(b){var c=f.find(".card-body");b.forEach(function(b){var d=$('<div class="quickreply-inner">{0}</div>'.format(b.associate)).data(b).appendTo(c);d.click(function(){var b=$(this).data();console.log(b);var c=a.closest(".card").find('textarea[name="replyContent"]')[0];wb.textarea.insert(c,b.text),a.parent().find(".card-quickreply-box").fadeOut(180)})})};wbcache.quickreplys?i(wbcache.quickreplys):apis.quickreplys().then(function(a){var b=a.data;wbcache.quickreplys=b,i(wbcache.quickreplys)});break;case"send-reply":var j=null;switch(c.task.type){case"MyStatuses":case"MyRetweeted":case"Retweeted":case"Statuses":j=apis.replyStatuses;break;case"Keywords":case"KeywordRetweeted":case"KeywordStatuses":j=apis.replyStatuses;break;case"AtMeComments":case"ToMeComments":j=apis.replyComments}var k=a.closest(".card").find('textarea[name="replyContent"]');k.attr("readonly",!0),a.attr("disabled",!0),wbui.plugin.fastoast({icon:"info",title:"正在处理",timer:0});var l=c.task.id,m=k.val();j(l,m).then(function(c){k.val(""),k.removeAttr("readonly"),a.removeAttr("disabled"),wbui.plugin.fastoast({icon:"success",title:"处理结束"});var d=k.closest(".card");d.slideUp(160,function(){d.remove(),b.onLoadMoreCardEvent()})})}}),d},statuses:function(a,b){console.log("原创微博",a);var c=$('<div class="card card-widget"/>');c.attr("data-idstr",a.task.idstr),c.data(a.task),c.append(wbui.userHeader(a.user,b));var d=$('<div class="card-body"/>').appendTo(c);d.append(wbui.checkbox(a.task,b));var e=$('<div class="wb-container"/>').appendTo(d);return e.append('<div class="wb-text">{0}</div>'.format(a.task.text)),e.append(wbui.mediaBody(a.task)),d.append(wbui.atTime(a.task)),d.append(wbui.weiboFrom(a.task)),d.append(wbui.uniqueMid(a.task)),d.append(wbui.assignInfo(a)),d.append(wbui.taskStatus(a)),c.append(wbui.toolsbar(a,b)),c.append(wbui.timeline(a,b)),c.append(wbui.replyBox(a,b)),c},retweet:function(a,b){console.log("转发微博",a);var c=$('<div class="card card-widget"/>');c.attr("data-idstr",a.task.idstr),c.data(a.task),c.append(wbui.userHeader(a.user,b));var d=$('<div class="card-body"/>').appendTo(c);d.append(wbui.checkbox(a.task,b));var e=$('<div class="wb-container"/>').appendTo(d);e.append('<div class="wb-text">{0}</div>'.format(a.task.text));var f=a.task.retweetedStatus,g=$('<div class="wb-container wb-container-retweet"/>').appendTo(e);return g.append('<div class="wb-text">{0}</div>'.format(f.text)),g.append(wbui.mediaBody(f)),d.append(wbui.atTime(a.task)),d.append(wbui.weiboFrom(a.task)),d.append(wbui.uniqueMid(a.task)),d.append(wbui.assignInfo(a)),d.append(wbui.taskStatus(a)),c.append(wbui.toolsbar(a,b)),c.append(wbui.timeline(a,b)),c.append(wbui.replyBox(a,b)),c},comment:function(a,b){console.log("微博评论",a);var c=$('<div class="card card-widget"/>');c.attr("data-idstr",a.task.idstr),c.data(a.task),c.append(wbui.userHeader(a.user,b));var d=$('<div class="card-body"/>').appendTo(c);d.append(wbui.checkbox(a.task,b));var e=$('<div class="wb-container"/>').appendTo(d);e.append('<div class="wb-text">{0}</div>'.format(a.task.text));var f=a.task.commentStatus,g=$('<div class="wb-container wb-container-retweet"/>').appendTo(e);return g.append('<div class="wb-text">{0}</div>'.format(f.text)),g.append(wbui.mediaBody(f)),d.append(wbui.atTime(a.task)),d.append(wbui.weiboFrom(a.task)),d.append(wbui.uniqueMid(a.task)),d.append(wbui.assignInfo(a)),d.append(wbui.taskStatus(a)),c.append(wbui.toolsbar(a,b)),c.append(wbui.timeline(a,b)),c.append(wbui.replyBox(a,b)),c},plugin:{virtual:{browser:{instance:null,instanceIframe:null,build:function(){if(!wbui.plugin.virtual.browser.instanceIframe){var a="";a+='<div class="plugin-virtual-browser">',a+="    <div>",a+='        <iframe src="/pages/plugins/virtual-browser.html"></iframe>',a+='        <div class="browser-navbar">',a+='            <span class="title"></span>',a+='            <span class="close">',a+='                <i class="nav-icon fab fa-slack"></i>',a+="            </span>",a+="        </div>",a+="    </div>",a+="</div>";var b=$(a);wbui.plugin.virtual.browser.instance=b;var c=b.find("iframe")[0];wbui.plugin.virtual.browser.instanceIframe=c,b.appendTo("body"),b.hide();var d=function(){console.log("页面加载完成",c.src)};c.attachEvent?c.attachEvent("onload",d):c.onload=d,b.find(".close").click(function(){wbui.plugin.virtual.browser.close()})}},open:function(){wbui.plugin.virtual.browser.instanceIframe||wbui.plugin.virtual.browser.build(),wbui.plugin.virtual.browser.instance.fadeIn(150)},close:function(){wbui.plugin.virtual.browser.instanceIframe||wbui.plugin.virtual.browser.build(),wbui.plugin.virtual.browser.instanceIframe.src="/pages/plugins/virtual-browser.html",wbui.plugin.virtual.browser.instance.fadeOut(150)},target:function(a){var b={utl:"",title:""},c=$.extend(b,a);wbui.plugin.virtual.browser.instanceIframe?(wbui.plugin.virtual.browser.open(),wbui.plugin.virtual.browser.instance.find(".title").html("正在加载"),setTimeout(function(){wbui.plugin.virtual.browser.instanceIframe.src=c.url,wbui.plugin.virtual.browser.instance.find(".title").html(c.title)},300)):(wbui.plugin.virtual.browser.build(),wbui.plugin.virtual.browser.open(),wbui.plugin.virtual.browser.instance.find(".title").html("正在加载"),setTimeout(function(){wbui.plugin.virtual.browser.instanceIframe.src=c.url,wbui.plugin.virtual.browser.instance.find(".title").html(c.title)},300))}}},fastoast:function(a){var b,c={icon:"info",title:"正在处理",timer:1500,onClose:function(){}},d=$.extend(c,a),e=$(".fastoast-mask");if(e.length)b=$(".fastoast");else{var f="";f+='<div class="fastoast-mask" style="display: none;">',f+='    <div class="fastoast">',f+='        <div class="fastoast-inner">',f+='            <div class="fastoast-icon">',f+='                <span class="fas fa-info-circle"></span>',f+="            </div>",f+='            <div class="fastoast-text">',f+="                正在处理",f+="            </div>",f+="        </div>",f+="    </div>",f+="</div>",$("body").append(f),e=$(".fastoast-mask"),b=$(".fastoast")}var g={info:"fas fa-info-circle",send:"fas fa-arrow-circle-up",download:"fas fa-file-download","package":"fas fa-save",save:"fas fa-file-archive",success:"fas fa-check-circle",fail:"fas fa-times-circle",warn:"fas fa-exclamation-circle",remove:"fas fa-trash-alt",cartdown:"fas fa-cart-arrow-down",success2:"fas fa-laugh-wink",error:"fas fa-sad-tear",setting:"fas fa-cogs"};return b.find(".fastoast-icon > span").attr("class",g[d.icon]),b.find(".fastoast-text").html(d.title),e.fadeIn("fast"),d.timer>0&&setTimeout(function(){e.fadeOut("fast"),d.onClose()},d.timer),{close:function(){e.fadeOut("fast")}}}}},commonui={pagination:function(a){var b={style:"horizontal",pageIndex:0,pageSize:10,totalSize:0,clickCallback:function(a){}},c=$.extend(b,a);c.totalSize=c.totalSize?c.totalSize:1;var d=Math.floor(c.totalSize/c.pageSize)+(c.totalSize%c.pageSize>0?1:0),e=c.pageIndex,f=e-5,g=e+5+1,h=d-1;f<0&&(g+=Math.abs(f),f=0);for(var i=[],j=0;j<d;++j)i.push(j);var k=$("<div/>"),l=null,m=null,n=null;switch(c.style){case"vertical":l=$('<div class="btn-group-vertical btn-block"/>').appendTo(k),m=$('<div class="btn-group-vertical btn-block"/>').appendTo(k),n=$('<div class="btn-group-vertical btn-block"/>').appendTo(k);break;case"horizontal":default:l=$('<div class="btn-group"/>').css("margin-right","6px").appendTo(k),m=$('<div class="btn-group"/>').css("margin-right","6px").appendTo(k),n=$('<div class="btn-group"/>').css("margin-right","6px").appendTo(k)}return l.append('<button type="button" class="btn btn-block btn-warning" data-index="0">首页</button>'),l.append($('<button type="button" class="btn btn-block btn-warning">上一页</button>').attr("data-index",function(){return c.pageIndex-1<0?0:c.pageIndex-1}())),i.slice(f,g).forEach(function(a,b){a===c.pageIndex?m.append($('<button type="button" class="btn btn-block btn-success" style="font-weight: bold;"/>').attr("data-index",a).html(a+1)):m.append($('<button type="button" class="btn btn-block btn-default"/>').attr("data-index",a).html(a+1))}),n.append($('<button type="button" class="btn btn-block btn-warning">下一页</button>').attr("data-index",function(){return c.pageIndex+1>h?-1:c.pageIndex+1}())),c.pageIndex<h?n.append($('<button type="button" class="btn btn-block btn-warning">尾页</button>').attr("data-index",function(){return h}())):n.append($('<button type="button" class="btn btn-block btn-warning">尾页</button>').attr("data-index",-1)),"horizontal"===c.style&&$("button",k).removeClass("btn-block"),$("button",k).click(function(a){var b=$(this).data("index");console.log("pagination index:",b),b!=-1&&c.clickCallback(b)}),k}};!function(a){a.fn.FCloudUpload=function(b){var c={id:"",url:"upload",autoUpload:!0,multipart:!0,upload:function(a){},onFormData:function(a){return a.serializeArray()},onChange:function(a,b){},onAppend:function(a,b,c,d){},onProgress:function(a,b,c,d,e){},onProgressAll:function(a,b,c){},onDoneAll:function(a,b){},onDone:function(a,b,c,d,e){},onFail:function(a,b){},onAlways:function(a,b){}},d=0,e=0,f={elementSelf:null,create:function(a){f.elementSelf=a,f.init(a)},init:function(b){a(b).fileupload({url:c.url,multipart:c.multipart,autoUpload:c.autoUpload,dataType:"json",formData:function(a){return c.onFormData(a)},change:function(a,b){d=Date.now(),e=0,c.onChange(a,b)},add:function(b,e){if(b.isDefaultPrevented())return!1;var f=e.files;for(var g in f){var h=f[g],i="hc"+d+h.lastModified+javaHashCode(h.name);c.onAppend(b,e,i,h)}e.autoUpload||e.autoUpload!==!1&&a(this).fileupload("option","autoUpload")?e.process().done(function(){e.submit()}):e.process().done(function(){c.upload&&c.upload(e)})},progress:function(a,b){var e=parseInt(b.loaded/b.total*100,10),f=b.files;for(var g in f){var h=f[g],i="hc"+d+h.lastModified+javaHashCode(h.name);c.onProgress(a,b,i,h,e)}},progressall:function(a,b){var d=parseInt(b.loaded/b.total*100,10);c.onProgressAll(a,b,d),100==d&&(e=d)},done:function(a,b){var f=b.files;for(var g in f){var h=f[g],i="hc"+d+h.lastModified+javaHashCode(h.name);c.onDone(a,b,i,h,b.result)}100==e&&c.onDoneAll(a,b)},fail:function(a,b){c.onFail(a,b)},always:function(a,b){c.onAlways(a,b)}})}};return this.each(function(d,e){a.extend(c,b),f.create(e)}),f}}(jQuery);